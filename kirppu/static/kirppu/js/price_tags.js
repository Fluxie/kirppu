(function(){var t;t=/^-?\d+([,\.]\d*)?$/,Number.isConvertible=function(e){return t.test(e)}}).call(this),function(){var t,e,r,i,n,o,a,u,s,l,c,d,_,m,p,f,h,v,b,g;e=function(){function t(){}return t.prototype.url_args={code:""},t.prototype.urls={roller:"",name_update:"",price_update:"",item_to_list:"",size_update:"",item_add:"",barcode_img:"",item_to_print:"",all_to_print:""},t.prototype.enabled=!0,t.prototype.name_update_url=function(t){var e;return e=this.urls.name_update,e.replace(this.url_args.code,t)},t.prototype.price_update_url=function(t){var e;return e=this.urls.price_update,e.replace(this.url_args.code,t)},t.prototype.item_to_list_url=function(t){var e;return e=this.urls.item_to_list,e.replace(this.url_args.code,t)},t.prototype.size_update_url=function(t){var e;return e=this.urls.size_update,e.replace(this.url_args.code,t)},t.prototype.barcode_img_url=function(t){var e;return e=this.urls.barcode_img,e.replace(this.url_args.code,t)},t.prototype.item_to_print_url=function(t){var e;return e=this.urls.item_to_print,e.replace(this.url_args.code,t)},t}(),t=new e,d=function(t,e,r,i,n,o){var a;return a=$(".item_template").clone(),a.removeClass("item_template"),"short"===o&&a.addClass("item_short"),"tiny"===o&&a.addClass("item_tiny"),$(".item_name",a).text(t),$(".item_price",a).text(e),$(".item_head_price",a).text(e),$(".item_vendor_id",a).text(r),$(a).attr("id",i),$(".item_extra_code",a).text(i),$(".barcode_container > img",a).attr("src",n),m&&a.addClass("item_list"),a},r=function(){var e,r,i;return i=function(t){var e,r,i,n,o;for($("#form-errors").empty(),o=[],i=0,n=t.length;n>i;i++)e=t[i],r=d(e.name,e.price,e.vendor_id,e.code,e.barcode_dataurl,e.type),$("#items").prepend(r),o.push(c($(r)));return o},r=function(t){return $("#form-errors").empty(),t.responseText?$("<p>"+t.responseText+"</p>").appendTo($("#form-errors")):void 0},e={name:$("#item-add-name").val(),price:$("#item-add-price").val(),range:$("#item-add-suffixes").val(),type:$("input[name=item-add-type]:checked").val()},$.ajax({url:t.urls.item_add,type:"POST",data:e,success:i,error:r})},_=function(){var e;confirm(gettext("This will mark all items as printed so they won't be printed again accidentally. Continue?"))&&(e=$("#items > .item_container"),$(e).hide("slow"),$.ajax({url:t.urls.all_to_print,type:"POST",success:function(){return $(e).each(function(t,e){var r;return r=$(e).attr("id"),h(e,r)})},error:function(){return $(e).show("slow")}}))},m=!1,b=function(){var t;return m=m?!1:!0,t=$("#items > .item_container"),m?t.addClass("item_list"):t.removeClass("item_list")},v=function(){var t,e,r;e=$(this),t=e.parents(".form-group"),r=e.val().replace(",","."),r>400||0>=r||!Number.isConvertible(r)?t.addClass("has-error"):t.removeClass("has-error")},i=function(){$("#item-add-form").bind("submit",function(){return r(),!1}),$("#delete_all").click(_),$("#list_view").click(b),$("#item-add-price").change(v)},l=function(e,r){$(".item_price",e).editable(t.price_update_url(r),{indicator:"<img src='"+t.urls.roller+"'>",tooltip:gettext("Click to edit..."),placeholder:gettext("<em>Click to edit</em>"),onblur:"submit",style:"width: 2cm",callback:function(t){return $(".item_head_price",e).text(t)}})},s=function(e,r){$(".item_name",e).editable(t.name_update_url(r),{indicator:"<img src='"+t.urls.roller+"'>",tooltip:gettext("Click to edit..."),placeholder:gettext("<em>Click to edit</em>"),onblur:"submit",style:"inherit"})},p=function(e,r){$.ajax({url:t.item_to_print_url(r),type:"POST",success:function(t){var r;return $(e).remove(),r=d(t.name,t.price,t.vendor_id,t.code,t.barcode_dataurl,t.type),$(r).hide(),$(r).appendTo("#items"),$(r).show("slow"),c($(r))},error:function(){return $(e).show("slow")}})},h=function(t,e){g($(t)),$(".item_button_delete",t).click(function(){return $(t).hide("slow",function(){return p(t,e)})}),$(t).prependTo("#printed_items"),$(t).addClass("item_list"),$(t).show("slow")},f=function(e,r){$.ajax({url:t.item_to_list_url(r),type:"POST",success:function(){return h(e,r)},error:function(){return $(e).show("slow")}})},o=function(t,e){$(".item_button_delete",t).click(function(){return $(t).hide("slow",function(){return f(t,e)})})},n=function(t,e){$(".item_button_delete",t).click(function(){return $(t).hide("slow",function(){return p(t,e)})})},a=function(e,r){var i,n,o;o=function(t){"tiny"===t?$(e).addClass("item_tiny"):$(e).removeClass("item_tiny"),"short"===t?$(e).addClass("item_short"):$(e).removeClass("item_short")},i=function(t){return t=function(){switch(t){case"tiny":return"short";case"short":return"long";case"long":return"tiny";default:return"short"}}()},n=function(){var n,a;a=$(e).hasClass("item_short")?"short":$(e).hasClass("item_tiny")?"tiny":"long",n=i(a),o(n),$.ajax({url:t.size_update_url(r),type:"POST",data:{tag_type:n},complete:function(t,e){return"success"!==e?o(a):void 0}})},$(".item_button_toggle",e).click(n)},c=function(e){e.each(function(e,r){var i;r=$(r),i=r.attr("id"),t.enabled?(l(r,i),s(r,i)):r.removeClass("item_editable"),o(r,i),a(r,i)})},u=function(t){t.each(function(t,e){var r;r=$(e).attr("id"),n(e,r)})},g=function(t){t.each(function(t,e){$(".item_name",e).unbind("click"),$(".item_price",e).unbind("click"),$(".item_button_toggle",e).unbind("click"),$(".item_button_delete",e).unbind("click")})},window.itemsConfig=t,window.addItem=r,window.deleteAll=_,window.bindTagEvents=c,window.bindListTagEvents=u,window.bindFormEvents=i}.call(this);